<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml" 
	xml:lang="en-US">
<head profile="http://www.w3.org/2005/10/profile">
<link rel="icon" 
      type="image/png" 
      href="//www.void.gr/favicon.ico" />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>November, 2012 | Into.the.Void.</title>
	<link media="screen" href="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/style.css" type="text/css" rel="stylesheet" />
	<style type="text/css" media="screen">
		/*******************************************************************
			Show link pointer images for external sites
		*******************************************************************/
		.entrybody a[href^="http"] {
			background: transparent url("http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/external_link.gif") no-repeat 100% 50%;
			padding-right: 10px;
			white-space: nowrap;
				}
		.entrybody a:hover[href^="http"] {
			background: #F3F4EC url("http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/external_link.gif") no-repeat 100% 50%;
		}
		/* This avoids the icon being shown on internal links.*/
		.entrybody a[href^="http://www.void.gr"],
		.entrybody a[href^="https://www.void.gr"],
		.entrybody a[href^="http://www.www.void.gr"],
		.entrybody a[href^="https://www.www.void.gr"] {
		    background: inherit;
		    padding-right: 0px;
		}
	</style>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://www.void.gr/kargig/blog/feed/" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://www.void.gr/kargig/blog/feed/rss/" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://www.void.gr/kargig/blog/feed/atom/" />
	<link rel="pingback" href="http://www.void.gr/kargig/blog/xmlrpc.php" />
	<link href="//www.myopenid.com/server" rel="openid.server" />
	<link href="//kargig.myopenid.com" rel="openid.delegate" /> 
    	<link rel='archives' title='July 2013' href='http://www.void.gr/kargig/blog/2013/07/' />
	<link rel='archives' title='May 2013' href='http://www.void.gr/kargig/blog/2013/05/' />
	<link rel='archives' title='February 2013' href='http://www.void.gr/kargig/blog/2013/02/' />
	<link rel='archives' title='January 2013' href='http://www.void.gr/kargig/blog/2013/01/' />
	<link rel='archives' title='November 2012' href='http://www.void.gr/kargig/blog/2012/11/' />
	<link rel='archives' title='October 2012' href='http://www.void.gr/kargig/blog/2012/10/' />
	<link rel='archives' title='September 2012' href='http://www.void.gr/kargig/blog/2012/09/' />
	<link rel='archives' title='August 2012' href='http://www.void.gr/kargig/blog/2012/08/' />
	<link rel='archives' title='June 2012' href='http://www.void.gr/kargig/blog/2012/06/' />
	<link rel='archives' title='May 2012' href='http://www.void.gr/kargig/blog/2012/05/' />
	<link rel='archives' title='April 2012' href='http://www.void.gr/kargig/blog/2012/04/' />
	<link rel='archives' title='January 2012' href='http://www.void.gr/kargig/blog/2012/01/' />
	<link rel='archives' title='December 2011' href='http://www.void.gr/kargig/blog/2011/12/' />
	<link rel='archives' title='November 2011' href='http://www.void.gr/kargig/blog/2011/11/' />
	<link rel='archives' title='October 2011' href='http://www.void.gr/kargig/blog/2011/10/' />
	<link rel='archives' title='August 2011' href='http://www.void.gr/kargig/blog/2011/08/' />
	<link rel='archives' title='July 2011' href='http://www.void.gr/kargig/blog/2011/07/' />
	<link rel='archives' title='June 2011' href='http://www.void.gr/kargig/blog/2011/06/' />
	<link rel='archives' title='May 2011' href='http://www.void.gr/kargig/blog/2011/05/' />
	<link rel='archives' title='April 2011' href='http://www.void.gr/kargig/blog/2011/04/' />
	<link rel='archives' title='March 2011' href='http://www.void.gr/kargig/blog/2011/03/' />
	<link rel='archives' title='February 2011' href='http://www.void.gr/kargig/blog/2011/02/' />
	<link rel='archives' title='November 2010' href='http://www.void.gr/kargig/blog/2010/11/' />
	<link rel='archives' title='October 2010' href='http://www.void.gr/kargig/blog/2010/10/' />
	<link rel='archives' title='August 2010' href='http://www.void.gr/kargig/blog/2010/08/' />
	<link rel='archives' title='July 2010' href='http://www.void.gr/kargig/blog/2010/07/' />
	<link rel='archives' title='May 2010' href='http://www.void.gr/kargig/blog/2010/05/' />
	<link rel='archives' title='April 2010' href='http://www.void.gr/kargig/blog/2010/04/' />
	<link rel='archives' title='March 2010' href='http://www.void.gr/kargig/blog/2010/03/' />
	<link rel='archives' title='February 2010' href='http://www.void.gr/kargig/blog/2010/02/' />
	<link rel='archives' title='January 2010' href='http://www.void.gr/kargig/blog/2010/01/' />
	<link rel='archives' title='November 2009' href='http://www.void.gr/kargig/blog/2009/11/' />
	<link rel='archives' title='October 2009' href='http://www.void.gr/kargig/blog/2009/10/' />
	<link rel='archives' title='September 2009' href='http://www.void.gr/kargig/blog/2009/09/' />
	<link rel='archives' title='August 2009' href='http://www.void.gr/kargig/blog/2009/08/' />
	<link rel='archives' title='July 2009' href='http://www.void.gr/kargig/blog/2009/07/' />
	<link rel='archives' title='June 2009' href='http://www.void.gr/kargig/blog/2009/06/' />
	<link rel='archives' title='May 2009' href='http://www.void.gr/kargig/blog/2009/05/' />
	<link rel='archives' title='April 2009' href='http://www.void.gr/kargig/blog/2009/04/' />
	<link rel='archives' title='March 2009' href='http://www.void.gr/kargig/blog/2009/03/' />
	<link rel='archives' title='February 2009' href='http://www.void.gr/kargig/blog/2009/02/' />
	<link rel='archives' title='November 2008' href='http://www.void.gr/kargig/blog/2008/11/' />
	<link rel='archives' title='July 2008' href='http://www.void.gr/kargig/blog/2008/07/' />
	<link rel='archives' title='June 2008' href='http://www.void.gr/kargig/blog/2008/06/' />
	<link rel='archives' title='May 2008' href='http://www.void.gr/kargig/blog/2008/05/' />
	<link rel='archives' title='April 2008' href='http://www.void.gr/kargig/blog/2008/04/' />
	<link rel='archives' title='March 2008' href='http://www.void.gr/kargig/blog/2008/03/' />
	<link rel='archives' title='February 2008' href='http://www.void.gr/kargig/blog/2008/02/' />
	<link rel='archives' title='October 2007' href='http://www.void.gr/kargig/blog/2007/10/' />
	<link rel='archives' title='September 2007' href='http://www.void.gr/kargig/blog/2007/09/' />
	<link rel='archives' title='August 2007' href='http://www.void.gr/kargig/blog/2007/08/' />
	<link rel='archives' title='July 2007' href='http://www.void.gr/kargig/blog/2007/07/' />
	<link rel='archives' title='June 2007' href='http://www.void.gr/kargig/blog/2007/06/' />
	<link rel='archives' title='May 2007' href='http://www.void.gr/kargig/blog/2007/05/' />
	<link rel='archives' title='April 2007' href='http://www.void.gr/kargig/blog/2007/04/' />
	<link rel='archives' title='March 2007' href='http://www.void.gr/kargig/blog/2007/03/' />
	<link rel='archives' title='February 2007' href='http://www.void.gr/kargig/blog/2007/02/' />
	<link rel='archives' title='January 2007' href='http://www.void.gr/kargig/blog/2007/01/' />
	<link rel='archives' title='December 2006' href='http://www.void.gr/kargig/blog/2006/12/' />
	<link rel='archives' title='November 2006' href='http://www.void.gr/kargig/blog/2006/11/' />
	<link rel='archives' title='October 2006' href='http://www.void.gr/kargig/blog/2006/10/' />
	<link rel='archives' title='September 2006' href='http://www.void.gr/kargig/blog/2006/09/' />
	<link rel='archives' title='July 2006' href='http://www.void.gr/kargig/blog/2006/07/' />
	<link rel='archives' title='June 2006' href='http://www.void.gr/kargig/blog/2006/06/' />
	<link rel='archives' title='May 2006' href='http://www.void.gr/kargig/blog/2006/05/' />
	<link rel='archives' title='April 2006' href='http://www.void.gr/kargig/blog/2006/04/' />
	<link rel='archives' title='March 2006' href='http://www.void.gr/kargig/blog/2006/03/' />
	<link rel='archives' title='February 2006' href='http://www.void.gr/kargig/blog/2006/02/' />
	<link rel='archives' title='January 2006' href='http://www.void.gr/kargig/blog/2006/01/' />
	<link rel='archives' title='December 2005' href='http://www.void.gr/kargig/blog/2005/12/' />
	<link rel='archives' title='November 2005' href='http://www.void.gr/kargig/blog/2005/11/' />
	<link rel='archives' title='October 2005' href='http://www.void.gr/kargig/blog/2005/10/' />
	<link rel='archives' title='September 2005' href='http://www.void.gr/kargig/blog/2005/09/' />
	<link rel='archives' title='August 2005' href='http://www.void.gr/kargig/blog/2005/08/' />
	<link rel='archives' title='July 2005' href='http://www.void.gr/kargig/blog/2005/07/' />
	<link rel='archives' title='June 2005' href='http://www.void.gr/kargig/blog/2005/06/' />
	<link rel='archives' title='May 2005' href='http://www.void.gr/kargig/blog/2005/05/' />
	<link rel='archives' title='April 2005' href='http://www.void.gr/kargig/blog/2005/04/' />
	<link rel='archives' title='March 2005' href='http://www.void.gr/kargig/blog/2005/03/' />
	<link rel='archives' title='February 2005' href='http://www.void.gr/kargig/blog/2005/02/' />
	<link rel='archives' title='January 2005' href='http://www.void.gr/kargig/blog/2005/01/' />
	<link rel='archives' title='December 2004' href='http://www.void.gr/kargig/blog/2004/12/' />
	<link rel='archives' title='November 2004' href='http://www.void.gr/kargig/blog/2004/11/' />
	<link rel='archives' title='October 2004' href='http://www.void.gr/kargig/blog/2004/10/' />
	<link rel='archives' title='September 2004' href='http://www.void.gr/kargig/blog/2004/09/' />
	<link rel='archives' title='August 2004' href='http://www.void.gr/kargig/blog/2004/08/' />
	<link rel='archives' title='July 2004' href='http://www.void.gr/kargig/blog/2004/07/' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.void.gr/kargig/blog/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.void.gr/kargig/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.void.gr/kargig/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.6" />

<!-- All in One SEO Pack 2.0.2 by Michael Torbert of Semper Fi Web Design[386,437] -->
<meta name="robots" content="noindex,follow" />

<link rel="canonical" href="http://www.void.gr/kargig/blog/2012/11/" />
<!-- /all in one seo pack -->
</head>

<body id="home" class="log">
<!-- <script type="text/javascript" src="//void.gr/kargig/blog/lightbox.js"></script> -->
<!-- The header begins  -->
		<div id="header">
			<h1><a href="http://www.void.gr/kargig/blog" title="Into.the.Void." >Into.the.Void.</a></h1>
			<div id="subtitle">
				<!-- Here's the tagline  -->
				Into The Void			</div>
		</div>
		<div id="headbar"></div>
		<!-- The header ends  -->
	<div id="container">
		<div id="maincol"><!-- The main content column begins  -->
			<div class="col">
<div class="entry">
                        <h2 class="entrydate">27/11/2012</h2>
                        <h3 class="entrytitle" id="post-1576"><a href="http://www.void.gr/kargig/blog/2012/11/27/world-city-map-of-tor-nodes/" rel="bookmark">World city map of Tor nodes</a></h3>
                        <div class="entrybody">
                                <p>Some months ago I started playing with the idea of creating a world map that would have every Tor node on it. Obviously I wan&#8217;t the first one&#8230;I soon discovered <a href="http://moblog.wiredwings.com/archives/20101213/Visualization-Tor-nodes-on-Google-Maps-and-Google-Earth.html">Moritz Bartl&#8217;s post</a> on the same topic. Luckilly he had <a href="https://github.com/moba/tormap">his code posted on Github</a> so I could fork it and add features that I wanted. The original python script parsed the consensus and the misrodescriptors, put Tor nodes into some classes and created a KML file with some description on each node.</p>
<p><strong>Some differences</strong><br />
I changed some parts of the python script to better suit my needs.<br />
a. Create a separate kml files for each Tor node class.<br />
b. Add new classes: Bad, Authority and Named.<br />
c. Pay more attention on requesting every external URL over HTTPS.<br />
d. Generate HTML code that displays those KMLs on a Google Maps overlay.<br />
e. Add some small randomization to each nodes&#8217;s coordinates so that nodes in the same city don&#8217;t overlap.</p>
<p>You can find a <a href="https://github.com/kargig/tormap/commits/master">complete changelog</a> at <a href="https://github.com/kargig/tormap">kargig/tormap GitHub repo</a>.</p>
<p>And here&#8217;s the outcome: <a href="https://tormap.void.gr/">World city map of Tor nodes</a> at https://tormap.void.gr/<br />
One of my main goals was to have selectable classes of nodes that will appear on the map.</p>
<p>To produce the map overlay, a cron script runs every hour, which is also the period it takes for Tor Authority nodes to produce a new consensus, and creates some static files which are then served by nginx.</p>
<p>I&#8217;m not a web developer/designer and I don&#8217;t really know any javascript. So please, feel free to fork my code and make it look better, run faster and add your own features. I&#8217;ll happily accept patches/pull requests!</p>
<p><strong>Extras</strong><br />
On <a href="https://github.com/kargig/tormap">kargig/tormap repo</a> you will also find a handy script, &#8216;runme.sh&#8217;, that downloads all necessary files that need to be parsed by the python script.</p>
<p><strong>Missplaced nodes on the map</strong><br />
Well, blame <a href="https://www.maxmind.com/en/city">MaxMind&#8217;s GeoIP City</a> database for that. But I think it&#8217;s kinda funny to see Tor nodes in Siberia and in the middle of the sea though (look at the West coast of Africa), heh. For those wondering, these nodes are gathered there because their geoip Lat,Long is set to 0,0.<br />
Really though, what&#8217;s &#8220;Ben&#8217;s Cat Shaque&#8221; diplayed there next to all those nodes in the west coast of Africa? Anyone has some clue ? </p>
<p><strong>Conspriracy people</strong><br />
I&#8217;m sure that people who love conspriracy theories will start posting about those &#8216;Bad&#8217; Tor nodes in Iran and Syria. Why do you think these are there ? What does it mean ? Let the flames begin!</p>
<p><strong>Future TODO</strong><br />
a. OpenStreetMap<br />
I have started working on an <a href="http://www.openstreetmap.org/">OpenStreetMap</a> implementation of the above using <a href="http://openlayers.org/">OpenLayers</a>. The biggest hurdle is that OSM does not provide a server that serves map tiles over HTTPS. Makes me wonder&#8230;is that actually so difficult ?<br />
b. More stats<br />
I would like to add small graphs on how the number of nodes in each class evolves.</p>
<p><strong>Other Tor mapping efforts</strong><br />
<a href="https://b.kentbackman.com/2010/10/04/view-tor-exit-nodes-in-google-earth/">https://b.kentbackman.com/2010/10/04/view-tor-exit-nodes-in-google-earth/</a><br />
<a href="http://freehaven.net/~ioerror/maps/v3-tormap.html">http://freehaven.net/~ioerror/maps/v3-tormap.html</a></p>
<p>Don&#8217;t forget, you can always help Tor by running a node/bridge or sending some money to Tor or EFF!</p>
                                <p class="comments_link">
                                       <img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/file.gif" title="file" alt="*" style=width:8px;height:9px;/>
                                        Filed by kargig at 01:55 under <a href="http://www.void.gr/kargig/blog/category/encryption/" title="View all posts in Encryption" rel="category tag">Encryption</a>,<a href="http://www.void.gr/kargig/blog/category/internet/" title="View all posts in Internet" rel="category tag">Internet</a>,<a href="http://www.void.gr/kargig/blog/category/linux/" title="View all posts in Linux" rel="category tag">Linux</a>,<a href="http://www.void.gr/kargig/blog/category/networking/" title="View all posts in Networking" rel="category tag">Networking</a>,<a href="http://www.void.gr/kargig/blog/category/privacy/" title="View all posts in Privacy" rel="category tag">Privacy</a><br />
	       	Tags: <a href="http://www.void.gr/kargig/blog/tag/authority/" rel="tag">Authority</a>, <a href="http://www.void.gr/kargig/blog/tag/bad/" rel="tag">Bad</a>, <a href="http://www.void.gr/kargig/blog/tag/consensus/" rel="tag">consensus</a>, <a href="http://www.void.gr/kargig/blog/tag/debian/" rel="tag">debian</a>, <a href="http://www.void.gr/kargig/blog/tag/geoip/" rel="tag">geoip</a>, <a href="http://www.void.gr/kargig/blog/tag/geoipcity/" rel="tag">geoipcity</a>, <a href="http://www.void.gr/kargig/blog/tag/google-maps/" rel="tag">Google maps</a>, <a href="http://www.void.gr/kargig/blog/tag/html/" rel="tag">html</a>, <a href="http://www.void.gr/kargig/blog/tag/javascript/" rel="tag">javascript</a>, <a href="http://www.void.gr/kargig/blog/tag/map/" rel="tag">map</a>, <a href="http://www.void.gr/kargig/blog/tag/mapping/" rel="tag">mapping</a>, <a href="http://www.void.gr/kargig/blog/tag/maxmind/" rel="tag">maxmind</a>, <a href="http://www.void.gr/kargig/blog/tag/nginx/" rel="tag">nginx</a>, <a href="http://www.void.gr/kargig/blog/tag/openstreemmap/" rel="tag">OpenStreemMap</a>, <a href="http://www.void.gr/kargig/blog/tag/python/" rel="tag">python</a>, <a href="http://www.void.gr/kargig/blog/tag/tor/" rel="tag">tor</a>, <a href="http://www.void.gr/kargig/blog/tag/tormap/" rel="tag">tormap</a>, <a href="http://www.void.gr/kargig/blog/tag/tormap-void-gr/" rel="tag">tormap.void.gr</a><br />               	<a href="http://www.void.gr/kargig/blog/2012/11/27/world-city-map-of-tor-nodes/#comments" title="Comment on World city map of Tor nodes"><img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/comments.gif"  title="comments" alt="*" style=width:9px;height:9px; /> 1 Comment</a>	 	 |  3,681 views      
<br />
				</p>
			</div>
	<!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.void.gr/kargig/blog/2012/11/27/world-city-map-of-tor-nodes/"
    dc:identifier="http://www.void.gr/kargig/blog/2012/11/27/world-city-map-of-tor-nodes/"
    dc:title="World city map of Tor nodes"
    trackback:ping="http://www.void.gr/kargig/blog/2012/11/27/world-city-map-of-tor-nodes/trackback/" />
</rdf:RDF>	-->
</div>



        <div class="entry">
                        <h2 class="entrydate">20/11/2012</h2>
                        <h3 class="entrytitle" id="post-1533"><a href="http://www.void.gr/kargig/blog/2012/11/20/scaling-a-small-streaming-system-from-50-to-4000-users/" rel="bookmark">Scaling a small streaming system from 50 to 4000+ users</a></h3>
                        <div class="entrybody">
                                <p>This post was originally written on 09/11/2012 but for various reasons it couldn&#8217;t be published earlier. It won&#8217;t be very technical, it&#8217;s mostly a behind the scenes view of how some of us at <a href="https://www.noc.grnet.gr/">NOC GRNET</a> tried to cope with an extreme spike of demands of a specific service we support.</p>
<p><strong>Intro</strong><br />
At <a href="http://www.grnet.gr/">GRNET</a> we provide a <a href="http://live.grnet.gr/parliament/">live streaming service</a> to the <a href="http://www.hellenicparliament.gr/">Hellenic Parliament</a>, who also connect to the Internet through our network. What we&#8217;re doing is that we&#8217;re serving the official TV channel of the Hellenic Parliament (the WebTV program actually). We have a machine that encodes (transcodes actually) video/audio and a separate streamer that serves the content to the clients via RTSP, RTMP and HTTP. While this service has been running for quite some time, and the streaming server has been used in various other occasions, it typically serves no more than 100 concurrent clients. With a stream at 640Kbps on average that&#8217;s abound 60Mbps of streaming traffic. The number of viewers usually goes up only when there&#8217;s something exciting going on. Our previous traffic spike was at 577Mbps on October 31st, when the Minister of Finance was presenting the budget for 2013 to the Parliament. What happened that day was that news reporters were on strike and it seems that one of the few news sources available at the time for people to use was the Parliament channel, either on the TV or <a href="http://live.grnet.gr/parliament/">through our stream</a>. The viewership that day surpassed all previous expectations but the streaming system actually performed quite well considering we didn&#8217;t have any complaints.</p>
<p><strong>Remember, remember the 7th of November</strong><br />
On the 7th of November almost everyone was on strike in Greece. There was a huge march arranged at 17:00 outside of the Greek Parliament to protest against the new harsh measures of Memorandum III that the parliament was to vote for at midnight.</p>
<p>We started seeing some traffic arriving, well leaving is more accurate, our streaming server at around 10:00 in the morning. Some news sites and blogs (tanea.gr, left.gr, protothema.gr) had already started posting links to <a href="http://live.grnet.gr/parliament/">our parliament&#8217;s streaming service</a> for people to watch the discussion that was already taking place. At around 10:30 we were already serving more than 100Mbps while the traffic was steadily rising. A bit after 12:00 though things got really nasty. Websites like tovima.gr, zougla.gr and newsit.gr had posted our streaming links in their very first page. The discussions both inside the parliament and on the social networks had also started heating up.  At 12:25 the traffic starting ramping up extremely fast!</p>
<blockquote><p>12:25 160Mbps<br />
12:32 367Mbps<br />
12:38 597Mbps<br />
12:42 756Mbps<br />
12:49 779Mbps</p></blockquote>
<p>That&#8217;s when traffic stopped growing any more. We actually saw some drop in the traffic and then up to 780Mbps and down again. It was obvious that we had reached some limit. It wasn&#8217;t very obvious though what the bottleneck was since the streaming system load was quite low, around 0.6-1.0 in a 4 vCPU VM and it also had a virtio-net/gigabit[1] network card. Theoretically it should be able to push at least 100-150 more Mbps. In order to cope with the increasing demand we changed the player web page in order to off-load some users to an experimental service that relies on IP multicast from the server and P2P between the clients for delivering streams. This bought us some time, about 2-3 hours. Also maybe because it was noon time, or due to more people using the experimental service or not being satisfied from the performance of the streaming video and disconnecting, traffic later on dropped &#8220;down&#8221; to an average of 650-700Mbits.</p>
<p>We started discussing short-term actions for improving the service so as to be able to cope with more demand. The streaming server was running on <a href="https://vima.grnet.gr">GRNET&#8217;s virtualization platform</a>, which is based on <a href="https://code.google.com/p/ganeti/">ganeti</a>, and the first thought we had was to try and add more network cards to the VM and somehow bond the cards together. Could we push more than 1Gbps from the same VM? The problem was that we couldn&#8217;t do any 802.3ad bonding since the &#8220;virtual switch&#8221; inside the virtualization platform did not support such features. One other solution would be to add another virtual network card and use Linux bonding mode 5 (balance-tlb) or 6 (balance-alb). After a bit of reading this mode was rejected as well. These two bonding modes expect from the ethernet card running on the machine to support ethtool to read their speed. Our VMs use virtio-net which doesn&#8217;t support this functionality for ethtool. We could switch to another type of network card, e1000 for example, but this could have an unmeasured/untested performance penalty which could actually negate the addition of a second network card.</p>
<p>Hundreds of thousands of Greeks were planning to join this huge protest starting at 17:00 and so were some of us working at GRNET, at least I was. We had to make a decision though, drop our plans and improve the streaming service to help more people, especially Greeks living abroad, to access the stream or just join others at Syntagma square? Our shift was ending soon anyway. We decided to stay at work and try and improve the service as far as we could.</p>
<p>The path we chose in order to &#8220;scale&#8221; was to create to a second instance of the streamer and try to &#8220;balance&#8221; client requests to both streamers using round robin DNS. That involved creating a checkpoint of the running VM at our storage system, copy the running VM&#8217;s image from that checkpoint as a new image and run a new VM with that image. So we would be cloning the current streaming service while the service was running and serving clients (take that Windows!).</p>
<p>So we provisioned a new Debian server through LDAP, added the copied image disks at the VM&#8217;s configuration, booted the VM, run <a href="http://puppetlabs.com/">puppet</a> to change the configuration files according to the new hostname and IP, and we were ready to serve more clients.  After some testing we created a RR DNS entry, &#8220;streamer-frontend.domain.gr&#8221; which pointed to both first-streamer.domain.gr and second-streamer.domain.gr and had a TTL of 60. Changing the landing page though to serve streamer-frontend.domain.gr as the streamer url wasn&#8217;t enough. The first problem was that there were news sites and blogs that had copied directly our first streamer&#8217;s URL instead of the live.grnet.gr/paliament/ landing page, which actually runs on a different system and is served by an Apache2 server (more on that later). Having already more than 1000 streams on the first streamer and then starting to do RR DNS on both servers meant that there would still be a large number of clients served by the first server and new people getting directed there would only make matters worse, while people directed to the second server would have a much better service experience.  So what we actually did was point streamer-frontend.domain.gr not on both first-streamer.domain.gr and second-streamer.domain.gr but just second-streamer.domain.gr. We also changed the IP address of first-streamer A,AAAA records to second-streamer&#8217;s IP and flushed the first-streamer RR at our caching resolvers. Since many people use our caching resolvers, especially students with DSL lines, we were able to direct even more people towards the second-streamer.</p>
<p>Before adding second-streamer.domain.gr:<br />
<pre><code2>* first-streamer.domain.gr -&gt; 1.2.3.4 TTL 86400
* live.grnet.gr/parliament/ pointing the streamer URL at first-streamer.domain.gr</code2></pre></p>
<p>After adding second-streamer.domain.gr:<br />
<pre><code2>* streamer-frontend.domain.gr -&gt; 1.2.3.5 TTL 60
* first-streamer.domain.gr -&gt; 1.2.3.5 TTL 60
* second-streamer.domain.gr -&gt; 1.2.3.5 TTL 60
* live.grnet.gr/parliament/ pointing the streamer URL at streamer-frontend.domain.gr</code2></pre></p>
<p>That way people disconnecting from the stream and reconnecting some time later on were pointed to the new server, if they used our landing page. That meant better quality streaming for both &#8220;old&#8221; clients getting their stream from first-streamer, and for the new clients that were being served from second-streamer.</p>
<p>Within 30 minutes since booting up, the second streamer was serving more than 250Mbps and after another 30&#8242; its traffic had climbed up to 450Mbps while first-streamer was steadily serving more than 550Mbits. That lead us to an all time record of 1.02Gbps at 17:45. At that point we were serving more than 2000 concurrent streams. A number we never expected for this humble streaming service.</p>
<p>While traffic was increasing through the addition of the second streamer, another problem came up. Some misconfigured clients and HTTP proxies were opening up connections at the Apache 2 serving the web page and never closed them down. We hit <a href="https://httpd.apache.org/docs/2.2/mod/mpm_common.html#serverlimit">Apache&#8217;s internal ServerLimit</a> variable of 256 around 17:00. We had to increase ServerLimit inside Apache&#8217;s config and restart it:</p>
<p><pre><code2>ServerLimit 500
&lt;IfModule mpm_prefork_module&gt;
&nbsp;&nbsp;&nbsp;&nbsp;StartServers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 
&nbsp;&nbsp;&nbsp;&nbsp;MinSpareServers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15 
&nbsp;&nbsp;&nbsp;&nbsp;MaxSpareServers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25 
&nbsp;&nbsp;&nbsp;&nbsp;MaxClients&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500
&nbsp;&nbsp;&nbsp;&nbsp;MaxRequestsPerChild&nbsp;&nbsp; 0&nbsp;&nbsp;
&lt;/IfModule&gt;</code2></pre></p>
<p>After some minutes of happiness another &#8220;unexpected&#8221; issue came up. It started to rain in Athens, so people who were at the protest at Syntagma square would probably leave soon and go home. There would certainly be an increase in traffic. And what about midnight, which is when the MPs were supposed to vote on the new measures? People would be sitting at their computers, bashing the politicians on Twitter and Facebook while watching the Parliament&#8217;s stream. At the same time we started seeing a big increase in international traffic, since more Greeks living abroad were tuning in; this stream was probably the only way they could watch what was happening at the Parliament.</p>
<p>That only meant one thing. Hello third-streamer! 10&#8242; later we had another streamer running. But we also wanted to make some changes to the first two VMs. We wanted to add more vCPUs, going from 4 to 8, add more RAM, going from 4096Mb to 6144Mb, and do some minor performance tuning on the software. That meant restarting the VMs in order to activate the additional resources&#8230; luckily the chairman of the Parliament announced a 10 minute recess some time around 19:30. That was our chance… we changed back first-streamer&#8217;s IP address, added it to streamer-frontend RR DNS while also adding third-streamer to it. Then we rebooted the first two VMs. After 30&#8243; we had 3 streamers running and waiting for clients to join them. third-streamer instantly got more than 200Mbps at the very moment we rebooted the other 2 VMs.</p>
<p>After adding third-streamer.domain.gr:<br />
<pre><code2>* streamer-frontend.domain.gr -&gt; {1.2.3.4 | 1.2.3.5 | 1.2.3.6} TTL 60
* first-streamer.domain.gr -&gt; 1.2.3.4 TTL 60
* second-streamer.domain.gr -&gt; 1.2.3.5 TTL 60
* third-streamer.domain.gr -&gt; 1.2.3.6 TTL 60
* live.grnet.gr/parliament/ pointing the streamer URL at streamer-frontend.domain.gr</code2></pre></p>
<p>At 20:10, some of us decided to leave work after 11 hours, having 3 streamers running that had already reached 1.2Gbps of traffic. There were more than 2800 concurrent users at the time&#8230;</p>
<p>Our assumptions for midnight came true. Around that time, more than 4000 people had tuned in to the parliament&#8217;s stream and we were pushing about 1.66 Gbps. That was probably the all-time record for a single service in GRNET.</p>
<p><strong>A big problem we didn&#8217;t solve that night</strong><br />
Unfortunately, each client gets a unique session id from the streamer, also when requesting an HTTP stream. These are not shared among the streamers, so if you send a subsequent HTTP request to a different streamer, who does not track that session id, it will not serve the request as expected but rather prompt the client to start a new session. Since some browsers did not cache the RRs of streamer-frontend long enough (remember that low TTL?) they would spread their requests to all the streamers. We knew this was happening but there was no way to solve this without extensive changes to the setup, which would have to be tested of course would mean significant downtime for the service. Therefore, depending on the browser people used, some got better or worse service than others. The good thing is that we know how to fix this in the future.</p>
<p><strong>Some Stats &#038; Graphs</strong><br />
more than 31000 unique IPs connecting to the streaming service<br />
more than 4000 concurrent users at peak time<br />
more than 4.7 TB of data streamed</p>
<p>first-streamer ethernet traffic:<br />
<a href="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer0.png"><img src="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer0.png" alt="" title="if_eth0-day_streamer0" width="497" height="280" class="aligncenter size-full wp-image-1562" /></a><br />
second-streamer ethernet traffic:<br />
<a href="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer1.png"><img src="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer1.png" alt="" title="if_eth0-day_streamer1" width="497" height="280" class="aligncenter size-full wp-image-1564" /></a><br />
third-streamer ethernet traffic:<br />
<a href="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer2.png"><img src="http://www.void.gr/kargig/blog/wp-content/if_eth0-day_streamer2.png" alt="" title="if_eth0-day_streamer2" width="497" height="280" class="aligncenter size-full wp-image-1563" /></a><br />
Streamer client types<br />
<a href="http://www.void.gr/kargig/blog/wp-content/parltv_20121107.png"><img src="http://www.void.gr/kargig/blog/wp-content/parltv_20121107-300x132.png" alt="" title="parltv_20121107" width="300" height="132" class="aligncenter size-medium wp-image-1565" /></a><br />
Streamer LAN traffic aggregates:<br />
<a href="http://www.void.gr/kargig/blog/wp-content/streamer_aggregate.png"><img src="http://www.void.gr/kargig/blog/wp-content/streamer_aggregate.png" alt="" title="streamer_aggregate" width="497" height="240" class="aligncenter size-full wp-image-1571" /></a></p>
<p>Create your own graphs here: <a href="http://mon.grnet.gr/rg/157184/details/">http://mon.grnet.gr/rg/157184/details/</a></p>
<p><strong>Epilogue</strong><br />
Yeah, there were hiccups in the stream for many many people, we acknowledge that. But we certainly did the best we could to keep the service running. Could we have done better ? Yes we could, but we would have to re-design the service and make some drastic changes that were never tested before. We didn&#8217;t want to risk making drastic changes that might not work at all while we could somewhat &#8220;scale&#8221; our service using a &#8220;working&#8221; solution. I wonder what will happen on Sunday when the Parliament votes for 2013 budget&#8230;Will we exceed our previous peak? We&#8217;ve already discussed alternatives to cope with the extra traffic and we&#8217;ll definitely be better prepared [2]!</p>
<p>I think that <a href="https://twitter.com/zmousm">zmousm</a>, alexandros and <a href="https://twitter.com/kargig">me</a> did a fairly good job regarding the circumstances. We should buy each other a beer sometime..We&#8217;ll treat <a href="https://twitter.com/faidonl">faidonl</a> another one though for his helpful consulting <img src='http://www.void.gr/kargig/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Since no external CDNs or other services provided by companies abroad were used, this might be the event with the biggest ever demand in network resources served from within Greece.</p>
<p>Do you like solving such problems ? Then there might be a lurking sysadmin inside you <img src='http://www.void.gr/kargig/blog/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> </p>
<p>[1] After a talk with <a href="https://twitter.com/apoikos">apoikos</a>, he corrected me saying that virtio-net does not have a &#8220;gigabit&#8221; capacity. Virtio-net&#8217;s capacity is only limited by the node resources available, so it can theoretically perform better than gigabit. So our thoughts on using balance-alb/tlb to cope with the extra bandwidth were wrong. This clue points out that the cause of bottleneck on the streamer that couldn’t go over 800Mbps was the streamer software itself since both VM’s and hardware node’s system load were low.</p>
<p>[2] On 11/11/2012 the Greek Parliament voted for 2013 budget. What we did prior to that day to cope with the traffic was to setup a new version of the streamer software, that actually came out on 08/11/2012 just one day after the initial spike, that had the option to disable session IDs. Then it was quite straightforward to add some <a href="https://www.varnish-cache.org/">varnish caches</a> in front of the streamers to serve the HTTP streams to the clients. Unfortunately client demand was somewhat lower, it only reached 0.92Gbps.</p>
                                <p class="comments_link">
                                       <img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/file.gif" title="file" alt="*" style=width:8px;height:9px;/>
                                        Filed by kargig at 11:15 under <a href="http://www.void.gr/kargig/blog/category/internet/" title="View all posts in Internet" rel="category tag">Internet</a>,<a href="http://www.void.gr/kargig/blog/category/networking/ipv6-networking/" title="View all posts in IPv6" rel="category tag">IPv6</a>,<a href="http://www.void.gr/kargig/blog/category/linux/" title="View all posts in Linux" rel="category tag">Linux</a>,<a href="http://www.void.gr/kargig/blog/category/networking/" title="View all posts in Networking" rel="category tag">Networking</a><br />
	       	Tags: <a href="http://www.void.gr/kargig/blog/tag/debian/" rel="tag">debian</a>, <a href="http://www.void.gr/kargig/blog/tag/ganeti/" rel="tag">ganeti</a>, <a href="http://www.void.gr/kargig/blog/tag/grnet/" rel="tag">grnet</a>, <a href="http://www.void.gr/kargig/blog/tag/linux/" rel="tag">Linux</a>, <a href="http://www.void.gr/kargig/blog/tag/parliament/" rel="tag">parliament</a>, <a href="http://www.void.gr/kargig/blog/tag/puppet/" rel="tag">puppet</a>, <a href="http://www.void.gr/kargig/blog/tag/scaling/" rel="tag">scaling</a>, <a href="http://www.void.gr/kargig/blog/tag/spike/" rel="tag">spike</a>, <a href="http://www.void.gr/kargig/blog/tag/streaming/" rel="tag">streaming</a>, <a href="http://www.void.gr/kargig/blog/tag/virtio-net/" rel="tag">virtio-net</a>, <a href="http://www.void.gr/kargig/blog/tag/virtual-machine/" rel="tag">virtual machine</a>, <a href="http://www.void.gr/kargig/blog/tag/virtualization/" rel="tag">virtualization</a><br />               	<a href="http://www.void.gr/kargig/blog/2012/11/20/scaling-a-small-streaming-system-from-50-to-4000-users/#comments" title="Comment on Scaling a small streaming system from 50 to 4000+ users"><img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/comments.gif"  title="comments" alt="*" style=width:9px;height:9px; /> 4 Comments</a>	 	 |  8,390 views      
<br />
				</p>
			</div>
	<!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.void.gr/kargig/blog/2012/11/20/scaling-a-small-streaming-system-from-50-to-4000-users/"
    dc:identifier="http://www.void.gr/kargig/blog/2012/11/20/scaling-a-small-streaming-system-from-50-to-4000-users/"
    dc:title="Scaling a small streaming system from 50 to 4000+ users"
    trackback:ping="http://www.void.gr/kargig/blog/2012/11/20/scaling-a-small-streaming-system-from-50-to-4000-users/trackback/" />
</rdf:RDF>	-->
</div>



        <div class="entry">
                        <h2 class="entrydate">12/11/2012</h2>
                        <h3 class="entrytitle" id="post-1548"><a href="http://www.void.gr/kargig/blog/2012/11/12/review-of-the-first-athens-cryptoparty/" rel="bookmark">Review of the first Athens CryptoParty</a></h3>
                        <div class="entrybody">
                                <p>On Sunday the 11th of November we finally had our <a href="https://www.hackerspace.gr/wiki/CryptoParty">first CryptoParty in Athens, Greece</a>. We hosted it at the <a href="https://www.hackerspace.gr/">Athens Hackerspace</a>.</p>
<p><strong>Organizing</strong><br />
We organized our first CryptoParty in a very ad-hoc way. A <a href="https://pad.void.gr:8443/p/cryptoparty_athens">pad</a> was set up and advertised on Twitter/Facebook. Almost immediately people started writing their thoughts, views and interests there. We soon had a list of topics that people were interested in and another list of people willing to give presentations/workshops. Later on we set up a <a href="http://doodle.com/gi97mxtwwufpagvy">doodle</a> so people would choose the most convenient dates for them. From the group of 50 people that originally expressed their interest to attend the CryptoParty, at least 20 voted on the doodle. That&#8217;s how the final date of November the 11th was chosen.</p>
<p>It was surprising/refreshing that even though everything was organized through an anonymously editable pad, nobody tried to vandalize it. </p>
<p><strong>The actual event</strong><br />
Through the pad, we chose 3 topics for the first meeting. &#8220;Using SSL/TLS for your Internet communications&#8221;, an &#8220;introduction to Tor&#8221; and another &#8220;introduction to I2P&#8221;.<br />
The time for the event was set for 12:00 in the morning, probably a very bad choice. The next one should definitely be later in the afternoon or even night. We learn by our mistakes though&#8230;People started showing up at around 11:30, but the event didn&#8217;t start until 12:30 when someone from <a href="https://www.hackerspace.gr">hackerspace.gr</a> gave a 5&#8242; intro talk about what the hackerspace is to people who had never been there before. People kept coming even until 13:00 and the audience had grown to more than 30 people.<br />
After the three workshops/presentations around 10-15 people stayed and we ordered pizza.</p>
<p>All in all I&#8217;d say it was fairly successful since more than 30 people came and actually did things to improve their security.</p>
<p><strong>The presentations/workshops</strong><br />
&#8220;<a href="https://void.gr/kargig/athens_cryptoparty/tls_kargig_cryptoparty_0.pdf">Using SSL/TLS for your Internet communications</a>&#8221; (in English) was <a href="https://twitter.com/kargig">my</a> effort to show people how cleartext data travels through the Internet and how any intermediate &#8220;bad guy&#8221;/LEA can easily read or manipulate your data. People were instructed to install wireshark so they could actually see for themselves what the actual problem is. It was very &#8220;nice&#8221; to see their surprise upon watching cleartext packets flowing through their network cards. It was even nicer to see their surprise when I used tcpdump on hackerspace&#8217;s router to redirect traffic to wireshark running on a Debian laptop to display their data, without having &#8220;direct&#8221; access to their computer. Then people were introduced to the idea of Transport Layer Security (SSL/TLS), and how HTTPS protects their web data from prying eyes. After this tiny &#8220;privacy apocalypse&#8221; it was very easy to convince users to install <a href="https://www.eff.org/https-everywhere/">HTTPS-Everywhere</a>. And so they did. Afterwards they got instructions on how they should change SSL/TLS settings for their E-email and IM clients.<br />
My original intention was to &#8220;scare&#8221; people a bit. It was funny to see their faces when they logged in to yahoo mail and they could see their emails cleartext on wireshark. People don&#8217;t understand how data travels through the Internet unless they experience it for themselves. I&#8217;m glad that people who had absolutely no idea about HTTPS are now using HTTPS-Everywhere to protect themselves. Hopefully they&#8217;ll show that to their friends as well.</p>
<p>&#8220;<a href="https://void.gr/kargig/Freedom_of_speech/Freedom_of_speech_2.pdf">Introduction to Tor</a>&#8221; (in Greek) gave people an idea at what anonymity is, how it differs from security and how users should be combining both TLS and Tor usage for security and anonymity at the same time. A brief explanation of what hidden services are was given as well. Even though George asked people to download and install Tor Browser Bundle and use it, we&#8217;ll definitely need more &#8220;hands on&#8221; Tor workshops in the  future. It will be interesting to convince more people to actually use it and why not, even set up their own hidden services.</p>
<p>&#8220;<a href="https://void.gr/kargig/athens_cryptoparty/i2p_cryptoparty.pdf">Invisible Internet Project a.k.a. I2P</a>&#8221; (in English) by <a href="https://twitter.com/alafroiskiotos">@alafroiskiotos</a> was probably the hardest of the three presentations to keep up for people that had no previous idea about anonymity networks. It&#8217;s unique architecture and some difficulties in it&#8217;s usage raised a lot of interesting questions by attendees.</p>
<p><strong>Thoughts on future CryptoParties</strong><br />
After the end of the workshops/presentations we had a lengthy discussion with the attendees as to what they would like to see/experience in the future CryptoParties. Unfortunately people were not very vocal. Very few participated and openly expressed their thoughts/opinions. A great part of the discussion was spent trying to figure out whom should CryptoParty presentations/workshops target at, users? developers? geeks? It&#8217;s obviously very hard to target all groups of people at the same time.</p>
<p>So here are my thoughts on what future CryptoParties should be. CryptoParties should be about changing user habits, they should be closer to workshops than presentations. They should be focused mainly on users not developers nor computer science students. Just simple users. People don&#8217;t want theoretical talks about cryptography, they need advice they can use in their daily lives. It&#8217;s already very hard to talk about modern crypto to people who haven&#8217;t got a strong mathematical background, you have to oversimplify things. Oversimplifying things then makes geeks/nerds unhappy and still doesn&#8217;t &#8220;teach&#8221; people about proper crypto. Even a fairly &#8220;simple&#8221; HTTPS negotiation contains key crypto concepts that are very difficult for a &#8220;crypto-newbie&#8221; to grasp. So it&#8217;s a lose-lose situation.</p>
<p>We need to teach, or better convince, users on using good, secure, audited tools and not just tell them about technologies and concepts. We, weirdos, might like that, but most users don&#8217;t. People need our help to learn how to avoid &#8220;fancy&#8221; tools and false security prophets. We need to show them how security should be applied in a layered approach. Getting people to care about their own privacy is key to the success of CryptoParties in the way I see them. To achieve that, we, people that know a few things more than the average Joe, should all become volunteers to such efforts. We should be joining CryptoParties in order to help others and not in order to improve ourselves and our knowledge. (Actually when you study in order to make a good workshop/presentation you improve your own knowledge as well, but let&#8217;s leave that beside for now.) We can have our separate geeky/nerdy events to present fancy tech and cool crypto stuff, but let&#8217;s keep CryptoParties simple and practical. Oh and we&#8217;ll need to repeat things again and again and again. That&#8217;s the only way people might change their habits.</p>
<p>If you want to find out more about the next Athens CryptoParty keep an eye at <a href="https://www.hackerspace.gr/wiki/Category:Events">Hackerspace&#8217;s events</a> and the <a href="https://pad.void.gr:8443/p/cryptoparty_athens">athens cryptoparty pad</a>. Join us!</p>
<p>Good luck to all the CryptoParties worldwide!</p>
                                <p class="comments_link">
                                       <img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/file.gif" title="file" alt="*" style=width:8px;height:9px;/>
                                        Filed by kargig at 21:23 under <a href="http://www.void.gr/kargig/blog/category/encryption/" title="View all posts in Encryption" rel="category tag">Encryption</a>,<a href="http://www.void.gr/kargig/blog/category/internet/" title="View all posts in Internet" rel="category tag">Internet</a>,<a href="http://www.void.gr/kargig/blog/category/linux/" title="View all posts in Linux" rel="category tag">Linux</a>,<a href="http://www.void.gr/kargig/blog/category/networking/" title="View all posts in Networking" rel="category tag">Networking</a>,<a href="http://www.void.gr/kargig/blog/category/privacy/" title="View all posts in Privacy" rel="category tag">Privacy</a><br />
	       	Tags: <a href="http://www.void.gr/kargig/blog/tag/anonymity/" rel="tag">anonymity</a>, <a href="http://www.void.gr/kargig/blog/tag/athens/" rel="tag">athens</a>, <a href="http://www.void.gr/kargig/blog/tag/cryptoparty/" rel="tag">CryptoParty</a>, <a href="http://www.void.gr/kargig/blog/tag/hsts/" rel="tag">HSTS</a>, <a href="http://www.void.gr/kargig/blog/tag/https/" rel="tag">https</a>, <a href="http://www.void.gr/kargig/blog/tag/https-everywhere/" rel="tag">HTTPS-Everywhere</a>, <a href="http://www.void.gr/kargig/blog/tag/i2p/" rel="tag">I2P</a>, <a href="http://www.void.gr/kargig/blog/tag/networking/" rel="tag">Networking</a>, <a href="http://www.void.gr/kargig/blog/tag/presentation/" rel="tag">presentation</a>, <a href="http://www.void.gr/kargig/blog/tag/privacy/" rel="tag">Privacy</a>, <a href="http://www.void.gr/kargig/blog/tag/security/" rel="tag">security</a>, <a href="http://www.void.gr/kargig/blog/tag/ssltls/" rel="tag">SSL/TLS</a>, <a href="http://www.void.gr/kargig/blog/tag/tcpdump/" rel="tag">tcpdump</a>, <a href="http://www.void.gr/kargig/blog/tag/tor/" rel="tag">tor</a>, <a href="http://www.void.gr/kargig/blog/tag/wireshark/" rel="tag">wireshark</a>, <a href="http://www.void.gr/kargig/blog/tag/workshop/" rel="tag">workshop</a><br />               	<a href="http://www.void.gr/kargig/blog/2012/11/12/review-of-the-first-athens-cryptoparty/#respond" title="Comment on Review of the first Athens CryptoParty">No Comments</a>	 	 |  2,257 views      
<br />
				</p>
			</div>
	<!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.void.gr/kargig/blog/2012/11/12/review-of-the-first-athens-cryptoparty/"
    dc:identifier="http://www.void.gr/kargig/blog/2012/11/12/review-of-the-first-athens-cryptoparty/"
    dc:title="Review of the first Athens CryptoParty"
    trackback:ping="http://www.void.gr/kargig/blog/2012/11/12/review-of-the-first-athens-cryptoparty/trackback/" />
</rdf:RDF>	-->
</div>



        <div class="entry">
                        <h2 class="entrydate">06/11/2012</h2>
                        <h3 class="entrytitle" id="post-1523"><a href="http://www.void.gr/kargig/blog/2012/11/06/when-in-doubt-always-blame-the-application/" rel="bookmark">When in doubt, always blame the application</a></h3>
                        <div class="entrybody">
                                <p>When you have a misbehaving system and you are not sure what the problem is, always bet on a poorly written application.</p>
<p>Here&#8217;s a small example of how another poorly written web application caused system issues.</p>
<p>I was sitting at my office today I when I got this nagios alert for a host.</p>
<blockquote><p>Date/Time: Tue Nov 6 19:15:11 EET 2012<br />
Additional Info:<br />
SWAP CRITICAL &#8211; 0% free (0 MB out of 509 MB)</p></blockquote>
<p>Logging in actually showed all the swap&#8217;s been used and so was RAM, 0.95/1Gb. Lots of apache2 server instances were running. I did a netstat and I saw a lot of ESTABLISHED connections:</p>
<p><pre><code2>tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:35571 2001:DB8:bar::100:80 ESTABLISHED 9631/apache2&nbsp;&nbsp;&nbsp;&nbsp;
tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:35777 2001:DB8:bar::100:80 ESTABLISHED 9656/apache2&nbsp;&nbsp;&nbsp;&nbsp;
tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:36531 2001:DB8:bar::100:80 ESTABLISHED 11578/apache2&nbsp;&nbsp; 
tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:36481 2001:DB8:bar::100:80 ESTABLISHED 11158/apache2&nbsp;&nbsp; 
tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:36295 2001:DB8:bar::100:80 ESTABLISHED 11115/apache2&nbsp;&nbsp; 
tcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2001:DB8:f00::1:34831 2001:DB8:bar::100:80 ESTABLISHED 8312/apache2&nbsp;&nbsp;</code2></pre>  </p>
<p>2001:DB8:f00::1   -> my server<br />
2001:DB8:bar::100 -> dst server</p>
<p>As one can easily see my server is connecting to port 80 of dst, possibly asking for something over HTTP.</p>
<p><pre><code2># netstat -antpW | grep 2001:DB8:bar::100 | wc -l
111</code2></pre></p>
<p><pre><code2># dig -x 2001:DB8:bar::100 +short&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
crl.randomcertauthority.com.</code2></pre></p>
<p>tailing the log files didn&#8217;t show anything weird happening. I run a tcpdump for that dst server but there wasn&#8217;t at that time any traffic going on.</p>
<p>So, I took a look at munin to see when this problem started developing.</p>
<p><a href="http://www.void.gr/kargig/blog/wp-content/fw_conntrack-day.png"><img src="http://www.void.gr/kargig/blog/wp-content/fw_conntrack-day.png" alt="" title="fw_conntrack-day" width="497" height="352" class="aligncenter size-full wp-image-1526" /></a><br />
<a href="http://www.void.gr/kargig/blog/wp-content/memory-day.png"><img src="http://www.void.gr/kargig/blog/wp-content/memory-day.png" alt="" title="memory-day" width="497" height="424" class="aligncenter size-full wp-image-1527" /></a><br />
<a href="http://www.void.gr/kargig/blog/wp-content/fw_conntrack-day.png"><img src="http://www.void.gr/kargig/blog/wp-content/fw_conntrack-day.png" alt="" title="fw_conntrack-day" width="497" height="352" class="aligncenter size-full wp-image-1526" /></a></p>
<p>As it&#8217;s obvious from the above graphs, the problem started around 14:00. So I took another look at the apache logs and I saw a bot crawling a specific url from my server. I visited that url on my server  using curl and I saw traffic flowing through tcpdump going from my server to dst server. So visiting that URL was definitely causing problems. But why?</p>
<p>I restarted apache, swap and memory were released, all the stale ESTABLISHED connections went away and I saw hundreds of FIN/RST packets going back and forth at tcpdump.</p>
<p>I tried to open a few concurrent connections from my PC to my server&#8217;s url using curl. After a couple of tries netstat showed that I had managed to create stale ESTABLISHED connections towards dst server. It was an HTTP connection asking for a crl. So I was both able to reproduce the problem and I also knew the specific url of the dst server that caused the connection hanging issues.<br />
Next thing I did was to try to open direct HTTP connections from my server to the dst url using curl. After a few concurrent connections I managed to make curl hang. So the problem was definitely not on my server, but at the dst server.</p>
<p>Since it was already quite late, my first (re)action was to install mod_evasive to try and minimize the problem so I could take a better look the next day.<br />
<pre><code2># aptitude install libapache2-mod-evasive
# a2enmod mod_evasive
### edit /etc/apache2/sites-enabled/site-name and add the following
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;IfModule mod_evasive20.c&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSHashTableSize&nbsp;&nbsp;&nbsp;&nbsp;3097
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSPageCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSSiteCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;50&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSPageInterval&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSSiteInterval&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSBlockingPeriod&nbsp;&nbsp; 10&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOSEmailNotify myemail@mydomain.gr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/IfModule&gt;
# /etc/init.d/apache2 reload
</code2></pre></p>
<p>I tried to curl my server&#8217;s URL from my PC and I got blocked after the second concurrent try. But after some repetitions I was still able to create one or two stale ESTABLISHED connections from my server to the dst server. Far fewer than before but the problem was still somewhat reproducible.</p>
<p>Then I decided to take a look at the site&#8217;s PHP code. Finding the culprit was quite easy, I just had to find the code segment where PHP requested the dst server&#8217;s url.<br />
Here&#8217;s the code segment:<br />
<pre><code2>$ch = curl_init($this-&gt;crl_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
$crl_content = curl_exec($ch);
</code2></pre></p>
<p>The developer had never thought that the remove server might keep the connection open for whatever reason (rate limiting anyone?)</p>
<p>Patching it was quite simple:<br />
<pre><code2>$ch = curl_init($this-&gt;crl_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT,&#039;60&#039;);
curl_setopt($ch, CURLOPT_TIMEOUT,&#039;60&#039;);
$crl_content = curl_exec($ch);
</code2></pre></p>
<p>After this everything worked fine again. Connections were getting ESTABLISHED but after 60 seconds they got torn down, automagically. No more stale ESTABLISHED connections. Hooray!</p>
<p>A letter to every developer:</p>
<blockquote><p>Dear developer,</p>
<p>please test your code before shipping. Pretty please take corner cases into account. We know you&#8217;re competent enough, don&#8217;t be lazy.</p>
<p>Your kind sysadmin</p></blockquote>
                                <p class="comments_link">
                                       <img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/file.gif" title="file" alt="*" style=width:8px;height:9px;/>
                                        Filed by kargig at 22:36 under <a href="http://www.void.gr/kargig/blog/category/internet/" title="View all posts in Internet" rel="category tag">Internet</a>,<a href="http://www.void.gr/kargig/blog/category/networking/ipv6-networking/" title="View all posts in IPv6" rel="category tag">IPv6</a>,<a href="http://www.void.gr/kargig/blog/category/linux/" title="View all posts in Linux" rel="category tag">Linux</a>,<a href="http://www.void.gr/kargig/blog/category/networking/" title="View all posts in Networking" rel="category tag">Networking</a><br />
	       	Tags: <a href="http://www.void.gr/kargig/blog/tag/apache2/" rel="tag">apache2</a>, <a href="http://www.void.gr/kargig/blog/tag/bug/" rel="tag">bug</a>, <a href="http://www.void.gr/kargig/blog/tag/curl/" rel="tag">curl</a>, <a href="http://www.void.gr/kargig/blog/tag/debian/" rel="tag">debian</a>, <a href="http://www.void.gr/kargig/blog/tag/http/" rel="tag">HTTP</a>, <a href="http://www.void.gr/kargig/blog/tag/libcurl/" rel="tag">libcurl</a>, <a href="http://www.void.gr/kargig/blog/tag/linux/" rel="tag">Linux</a>, <a href="http://www.void.gr/kargig/blog/tag/mod_evasive/" rel="tag">mod_evasive</a>, <a href="http://www.void.gr/kargig/blog/tag/munin/" rel="tag">munin</a>, <a href="http://www.void.gr/kargig/blog/tag/nagios3/" rel="tag">nagios3</a>, <a href="http://www.void.gr/kargig/blog/tag/php/" rel="tag">php</a>, <a href="http://www.void.gr/kargig/blog/tag/tcpdump/" rel="tag">tcpdump</a><br />               	<a href="http://www.void.gr/kargig/blog/2012/11/06/when-in-doubt-always-blame-the-application/#comments" title="Comment on When in doubt, always blame the application"><img src="http://www.void.gr/kargig/blog/wp-content/themes/gentle_calm/images/comments.gif"  title="comments" alt="*" style=width:9px;height:9px; /> 1 Comment</a>	 	 |  1,722 views      
<br />
				</p>
			</div>
	<!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.void.gr/kargig/blog/2012/11/06/when-in-doubt-always-blame-the-application/"
    dc:identifier="http://www.void.gr/kargig/blog/2012/11/06/when-in-doubt-always-blame-the-application/"
    dc:title="When in doubt, always blame the application"
    trackback:ping="http://www.void.gr/kargig/blog/2012/11/06/when-in-doubt-always-blame-the-application/trackback/" />
</rdf:RDF>	-->
</div>



        
                <div class="navigation">
                      <div class="alignleft"></div>
                      <div class="alignright"></div>
                </div>
</div>
</div><!-- The main content column ends  -->
<!-- begin sidebar -->
<ul class="nodecor">
	<li>
		</li>
</ul>
<ul class="nodecor">
	<li>
		<div id="navcol">
		<form method="get" id="searchform" action="/kargig/blog/index.php">
<div><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>		<h2>Links</h2>
		<ul class="nodecor">
			<li><a href="http://www.void.gr/kargig/blog" title="Into.the.Void." >Home</a></li>
			<li><a href="http://www.void.gr/kargig/blog/feed/" title="Syndicate this site using RSS"><abbr title="Really Simple Syndication">RSS</abbr></a></li>
		</ul>
		<table id="wp-calendar">
	<caption>November 2012</caption>
	<thead>
	<tr>
		<th scope="col" title="Monday">M</th>
		<th scope="col" title="Tuesday">T</th>
		<th scope="col" title="Wednesday">W</th>
		<th scope="col" title="Thursday">T</th>
		<th scope="col" title="Friday">F</th>
		<th scope="col" title="Saturday">S</th>
		<th scope="col" title="Sunday">S</th>
	</tr>
	</thead>

	<tfoot>
	<tr>
		<td colspan="3" id="prev"><a href="http://www.void.gr/kargig/blog/2012/10/" title="View posts for October 2012">&laquo; Oct</a></td>
		<td class="pad">&nbsp;</td>
		<td colspan="3" id="next"><a href="http://www.void.gr/kargig/blog/2013/01/" title="View posts for January 2013">Jan &raquo;</a></td>
	</tr>
	</tfoot>

	<tbody>
	<tr>
		<td colspan="3" class="pad">&nbsp;</td><td>1</td><td>2</td><td>3</td><td>4</td>
	</tr>
	<tr>
		<td>5</td><td><a href="http://www.void.gr/kargig/blog/2012/11/06/" title="When in doubt, always blame the application">6</a></td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td>
	</tr>
	<tr>
		<td><a href="http://www.void.gr/kargig/blog/2012/11/12/" title="Review of the first Athens CryptoParty">12</a></td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td>
	</tr>
	<tr>
		<td>19</td><td><a href="http://www.void.gr/kargig/blog/2012/11/20/" title="Scaling a small streaming system from 50 to 4000+ users">20</a></td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td>
	</tr>
	<tr>
		<td>26</td><td><a href="http://www.void.gr/kargig/blog/2012/11/27/" title="World city map of Tor nodes">27</a></td><td>28</td><td>29</td><td>30</td>
		<td class="pad" colspan="2">&nbsp;</td>
	</tr>
	</tbody>
	</table>		<h2>Archives</h2>
		<ul class="nodecor">
				<li><a href='http://www.void.gr/kargig/blog/2013/' title='2013'>2013</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2012/' title='2012'>2012</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2011/' title='2011'>2011</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2010/' title='2010'>2010</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2009/' title='2009'>2009</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2008/' title='2008'>2008</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2007/' title='2007'>2007</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2006/' title='2006'>2006</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2005/' title='2005'>2005</a></li>
	<li><a href='http://www.void.gr/kargig/blog/2004/' title='2004'>2004</a></li>
		</ul>

				<ul class="nodecor">
   			<li><h2>Recent Comments:</h2>
        	<ul>
        			<li><a href="http://www.void.gr/kargig/blog/2009/03/16/convert-greek-characters-from-latin1-mysql-database-fields-to-pure-utf8/#comment-400369" title="Convert greek characters from latin1 mysql database fields to pure utf8, 16/03/2009">yanes</a>: I &#8216;ve been searching and trying many different things last 3...</li>
	<li><a href="http://www.void.gr/kargig/blog/2013/07/23/another-day-another-hacked-website/#comment-395220" title="Another day another hacked website, 23/07/2013">giannis</a>: Disabling &#8216;allow_url_fopen&#8217; is also a good measure....</li>
	<li><a href="http://www.void.gr/kargig/blog/2013/07/23/another-day-another-hacked-website/#comment-394538" title="Another day another hacked website, 23/07/2013">Underhack</a>: Lucky you then;-)</li>
	<li><a href="http://www.void.gr/kargig/blog/2013/07/23/another-day-another-hacked-website/#comment-394535" title="Another day another hacked website, 23/07/2013">kargig</a>: I&#8217;m lucky enough to be able to sleep without getting nagios...</li>
	<li><a href="http://www.void.gr/kargig/blog/2013/07/23/another-day-another-hacked-website/#comment-394532" title="Another day another hacked website, 23/07/2013">Underhack</a>: The only thing that i can gain from this so nice article is the...</li>
 		</ul>
		 			<ul class="nodecor">
                        <h2>Most Viewed Posts:</h2>
      				<li><a href="http://www.void.gr/kargig/blog/2009/05/02/some-statistics-on-linux-greek-users-mailing-list-and-forumhelluggr/"  title="Some statistics on linux-greek-users mailing list and forum.hellug.gr">Some statistics on linux-greek-users mailing list and forum.hellug.gr</a> - 79,485 views</li><li><a href="http://www.void.gr/kargig/blog/2009/08/21/theres-a-rootkit-in-the-closet/"  title="There&#8217;s a rootkit in the closet!">There&#8217;s a rootkit in the closet!</a> - 72,337 views</li><li><a href="http://www.void.gr/kargig/blog/2008/05/17/openvpn-multi-bad-source-address-from-client-solution/"  title="Openvpn &#8211; MULTI: bad source address from client &#8211; solution">Openvpn &#8211; MULTI: bad source address from client &#8211; solution</a> - 55,251 views</li><li><a href="http://www.void.gr/kargig/blog/2006/01/24/ssh-escape-characters/"  title="SSH Escape Characters">SSH Escape Characters</a> - 44,734 views</li><li><a href="http://www.void.gr/kargig/blog/greek-adblock-plus-filter/"  title="Greek adblock plus filter">Greek adblock plus filter</a> - 31,450 views</li><li><a href="http://www.void.gr/kargig/blog/2012/01/11/linux-ssd-partition-alignment-tips/"  title="Linux SSD partition alignment tips">Linux SSD partition alignment tips</a> - 26,794 views</li><li><a href="http://www.void.gr/kargig/blog/2008/07/06/mac-os-x-tipsreminders/"  title="Mac OS X tips/reminders">Mac OS X tips/reminders</a> - 21,303 views</li><li><a href="http://www.void.gr/kargig/blog/2008/06/27/rxvt-unicode-256-color-support-with-vim/"  title="rxvt-unicode 256 color support with vim">rxvt-unicode 256 color support with vim</a> - 20,294 views</li><li><a href="http://www.void.gr/kargig/blog/2006/07/18/cedega-warcraft-iii-120e-nocd-patch/"  title="Cedega   Warcraft III 1.20e  nocd patch">Cedega   Warcraft III 1.20e  nocd patch</a> - 18,519 views</li><li><a href="http://www.void.gr/kargig/blog/2008/05/19/kernel-fun/"  title="kernel fun">kernel fun</a> - 18,362 views</li>   			</ul>
		 
   	</li>
</ul>
    

  

		<h2>Categories</h2>
		<ul id="linkslist">
				<li class="cat-item cat-item-6"><a href="http://www.void.gr/kargig/blog/category/encryption/" title="View all posts filed under Encryption">Encryption</a> (21)
</li>
	<li class="cat-item cat-item-1"><a href="http://www.void.gr/kargig/blog/category/general/" title="View all posts filed under General">General</a> (175)
</li>
	<li class="cat-item cat-item-12"><a href="http://www.void.gr/kargig/blog/category/linux/gentoo/" title="View all posts filed under Gentoo">Gentoo</a> (37)
</li>
	<li class="cat-item cat-item-11"><a href="http://www.void.gr/kargig/blog/category/greek/" title="View all posts filed under Greek">Greek</a> (33)
</li>
	<li class="cat-item cat-item-5"><a href="http://www.void.gr/kargig/blog/category/internet/" title="View all posts filed under Internet">Internet</a> (97)
</li>
	<li class="cat-item cat-item-414"><a href="http://www.void.gr/kargig/blog/category/networking/ipv6-networking/" title="View all posts filed under IPv6">IPv6</a> (15)
</li>
	<li class="cat-item cat-item-3"><a href="http://www.void.gr/kargig/blog/category/linux/" title="View all posts filed under Linux">Linux</a> (236)
</li>
	<li class="cat-item cat-item-13"><a href="http://www.void.gr/kargig/blog/category/macosx/" title="View all posts filed under MacOSX">MacOSX</a> (8)
</li>
	<li class="cat-item cat-item-7"><a href="http://www.void.gr/kargig/blog/category/maths/" title="View all posts filed under maths">maths</a> (2)
</li>
	<li class="cat-item cat-item-8"><a href="http://www.void.gr/kargig/blog/category/networking/" title="View all posts filed under Networking">Networking</a> (62)
</li>
	<li class="cat-item cat-item-4"><a href="http://www.void.gr/kargig/blog/category/privacy/" title="View all posts filed under Privacy">Privacy</a> (37)
</li>
	<li class="cat-item cat-item-2"><a href="http://www.void.gr/kargig/blog/category/private/" title="View all posts filed under Private">Private</a> (12)
</li>
	<li class="cat-item cat-item-10"><a href="http://www.void.gr/kargig/blog/category/slogans/" title="Slogans written on the walls">slogans</a> (6)
</li>
	<li class="cat-item cat-item-9"><a href="http://www.void.gr/kargig/blog/category/voip/" title="View all posts filed under VoIP">VoIP</a> (5)
</li>
		</ul>
		<h2>Tag Cloud</h2>
		<a href='http://www.void.gr/kargig/blog/tag/adblock/' class='tag-link-138' title='6 topics' style='font-size: 10.892561983471pt;'>adblock</a>
<a href='http://www.void.gr/kargig/blog/tag/adblock-plus/' class='tag-link-127' title='5 topics' style='font-size: 10.082644628099pt;'>adblock plus</a>
<a href='http://www.void.gr/kargig/blog/tag/ads/' class='tag-link-140' title='4 topics' style='font-size: 9.1570247933884pt;'>ads</a>
<a href='http://www.void.gr/kargig/blog/tag/antispam/' class='tag-link-239' title='4 topics' style='font-size: 9.1570247933884pt;'>antispam</a>
<a href='http://www.void.gr/kargig/blog/tag/athens/' class='tag-link-259' title='4 topics' style='font-size: 9.1570247933884pt;'>athens</a>
<a href='http://www.void.gr/kargig/blog/tag/bash/' class='tag-link-25' title='4 topics' style='font-size: 9.1570247933884pt;'>bash</a>
<a href='http://www.void.gr/kargig/blog/tag/blacklist/' class='tag-link-242' title='5 topics' style='font-size: 10.082644628099pt;'>blacklist</a>
<a href='http://www.void.gr/kargig/blog/tag/bug/' class='tag-link-37' title='11 topics' style='font-size: 13.553719008264pt;'>bug</a>
<a href='http://www.void.gr/kargig/blog/tag/bugzilla/' class='tag-link-36' title='4 topics' style='font-size: 9.1570247933884pt;'>bugzilla</a>
<a href='http://www.void.gr/kargig/blog/tag/debian/' class='tag-link-33' title='35 topics' style='font-size: 19.107438016529pt;'>debian</a>
<a href='http://www.void.gr/kargig/blog/tag/dhcpv6/' class='tag-link-342' title='4 topics' style='font-size: 9.1570247933884pt;'>DHCPv6</a>
<a href='http://www.void.gr/kargig/blog/tag/dns/' class='tag-link-199' title='6 topics' style='font-size: 10.892561983471pt;'>dns</a>
<a href='http://www.void.gr/kargig/blog/tag/email/' class='tag-link-247' title='5 topics' style='font-size: 10.082644628099pt;'>email</a>
<a href='http://www.void.gr/kargig/blog/tag/firefox/' class='tag-link-114' title='10 topics' style='font-size: 13.090909090909pt;'>firefox</a>
<a href='http://www.void.gr/kargig/blog/tag/fluxbox/' class='tag-link-107' title='4 topics' style='font-size: 9.1570247933884pt;'>fluxbox</a>
<a href='http://www.void.gr/kargig/blog/tag/fosscomm/' class='tag-link-79' title='5 topics' style='font-size: 10.082644628099pt;'>fosscomm</a>
<a href='http://www.void.gr/kargig/blog/tag/gentoo/' class='tag-link-12' title='19 topics' style='font-size: 16.099173553719pt;'>Gentoo</a>
<a href='http://www.void.gr/kargig/blog/tag/greek/' class='tag-link-11' title='11 topics' style='font-size: 13.553719008264pt;'>Greek</a>
<a href='http://www.void.gr/kargig/blog/tag/grrbl/' class='tag-link-237' title='6 topics' style='font-size: 10.892561983471pt;'>grrbl</a>
<a href='http://www.void.gr/kargig/blog/tag/https/' class='tag-link-325' title='4 topics' style='font-size: 9.1570247933884pt;'>https</a>
<a href='http://www.void.gr/kargig/blog/tag/iceweasel/' class='tag-link-125' title='5 topics' style='font-size: 10.082644628099pt;'>iceweasel</a>
<a href='http://www.void.gr/kargig/blog/tag/internet/' class='tag-link-5' title='5 topics' style='font-size: 10.082644628099pt;'>Internet</a>
<a href='http://www.void.gr/kargig/blog/tag/ipv6/' class='tag-link-301' title='16 topics' style='font-size: 15.289256198347pt;'>ipv6</a>
<a href='http://www.void.gr/kargig/blog/tag/linux/' class='tag-link-3' title='64 topics' style='font-size: 22pt;'>Linux</a>
<a href='http://www.void.gr/kargig/blog/tag/macbook/' class='tag-link-27' title='3 topics' style='font-size: 8pt;'>macbook</a>
<a href='http://www.void.gr/kargig/blog/tag/macosx/' class='tag-link-13' title='3 topics' style='font-size: 8pt;'>MacOSX</a>
<a href='http://www.void.gr/kargig/blog/tag/mysql/' class='tag-link-19' title='5 topics' style='font-size: 10.082644628099pt;'>mysql</a>
<a href='http://www.void.gr/kargig/blog/tag/networking/' class='tag-link-8' title='15 topics' style='font-size: 14.942148760331pt;'>Networking</a>
<a href='http://www.void.gr/kargig/blog/tag/oneliner/' class='tag-link-47' title='3 topics' style='font-size: 8pt;'>oneliner</a>
<a href='http://www.void.gr/kargig/blog/tag/ossec/' class='tag-link-217' title='4 topics' style='font-size: 9.1570247933884pt;'>ossec</a>
<a href='http://www.void.gr/kargig/blog/tag/perl/' class='tag-link-48' title='7 topics' style='font-size: 11.471074380165pt;'>perl</a>
<a href='http://www.void.gr/kargig/blog/tag/php/' class='tag-link-277' title='4 topics' style='font-size: 9.1570247933884pt;'>php</a>
<a href='http://www.void.gr/kargig/blog/tag/plesk/' class='tag-link-209' title='4 topics' style='font-size: 9.1570247933884pt;'>plesk</a>
<a href='http://www.void.gr/kargig/blog/tag/portage/' class='tag-link-86' title='4 topics' style='font-size: 9.1570247933884pt;'>portage</a>
<a href='http://www.void.gr/kargig/blog/tag/presentation/' class='tag-link-362' title='7 topics' style='font-size: 11.471074380165pt;'>presentation</a>
<a href='http://www.void.gr/kargig/blog/tag/privacy/' class='tag-link-4' title='8 topics' style='font-size: 12.04958677686pt;'>Privacy</a>
<a href='http://www.void.gr/kargig/blog/tag/script/' class='tag-link-49' title='3 topics' style='font-size: 8pt;'>script</a>
<a href='http://www.void.gr/kargig/blog/tag/security/' class='tag-link-206' title='16 topics' style='font-size: 15.289256198347pt;'>security</a>
<a href='http://www.void.gr/kargig/blog/tag/slaac/' class='tag-link-341' title='5 topics' style='font-size: 10.082644628099pt;'>slaac</a>
<a href='http://www.void.gr/kargig/blog/tag/spam/' class='tag-link-238' title='9 topics' style='font-size: 12.628099173554pt;'>spam</a>
<a href='http://www.void.gr/kargig/blog/tag/swiftfox/' class='tag-link-126' title='4 topics' style='font-size: 9.1570247933884pt;'>swiftfox</a>
<a href='http://www.void.gr/kargig/blog/tag/tor/' class='tag-link-474' title='5 topics' style='font-size: 10.082644628099pt;'>tor</a>
<a href='http://www.void.gr/kargig/blog/tag/vulnerability/' class='tag-link-185' title='6 topics' style='font-size: 10.892561983471pt;'>vulnerability</a>
<a href='http://www.void.gr/kargig/blog/tag/wordpress/' class='tag-link-16' title='4 topics' style='font-size: 9.1570247933884pt;'>wordpress</a>
<a href='http://www.void.gr/kargig/blog/tag/zsh/' class='tag-link-60' title='3 topics' style='font-size: 8pt;'>zsh</a>		<ul class="nodecor">
		<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-309"><a href="http://www.void.gr/kargig/blog/contact/">Contact</a></li>
<li class="page_item page-item-639"><a href="http://www.void.gr/kargig/blog/greek-adblock-plus-filter/">Greek adblock plus filter</a></li>
<li class="page_item page-item-1014"><a href="http://www.void.gr/kargig/blog/grrbl/">GrRBL</a></li>
<li class="page_item page-item-299"><a href="http://www.void.gr/kargig/blog/my-dot-files/">My dot files</a></li>
<li class="page_item page-item-296"><a href="http://www.void.gr/kargig/blog/pgp-keys/">My PGP/GPG key</a></li>
<li class="page_item page-item-310"><a href="http://www.void.gr/kargig/blog/presentations/">Presentations/Articles</a></li>
</ul></li>		  <li id="linkcat-15" class="linkcat"><h2>Blogs</h2>
	<ul>
<li><a href="http://modal-echoes.blogspot.com/"> modal echoes of the void</a></li>
<li><a href="http://sysadmin-dmesg.blogspot.com/">$ dmesg_</a></li>
<li><a href="http://autoverse.net/">.: autoverse :.</a></li>
<li><a href="http://idaru.blogspot.com/">/home/idaru</a></li>
<li><a href="http://0entropy.blogspot.com/" title="Security, system administration" target="_blank">0entropy</a></li>
<li><a href="http://tokakoki.blogspot.com/">About life, the universe and everything</a></li>
<li><a href="http://sysc.tl">argp&#039;s blog</a></li>
<li><a href="http://lixtetrax.typepad.com/">Cyberpunk As a Commodity</a></li>
<li><a href="http://dimitris.apeiro.gr">dimitris kalamaras</a></li>
<li><a href="http://stsimb.irc.gr/">Don’t fear the penguin</a></li>
<li><a href="http://e-provatina.blogspot.com/" title="περιηγητικό blog" target="_blank">e-Προβατίνα</a></li>
<li><a href="http://blog.ltsampros.eu/">Leonidas Tsampros</a></li>
<li><a href="http://blog.nihilnovo.eu/">nihil novo (nothing new)</a></li>
<li><a href="http://thatha.qlabs.gr/blog/">Reckoning</a></li>
<li><a href="http://panoskrt.wordpress.com/">vortex of false deceit</a></li>
<li><a href="http://hwoarang.silverarrow.gr">Yet another open source blog ;)</a></li>
<li><a href="http://blog.hsoc.eu/">μα εγώ δεν ξέρω ρίμες</a></li>

	</ul>
</li>
  <li id="linkcat-14" class="linkcat"><h2>Links</h2>
	<ul>
<li><a href="http://census-labs.com/" target="_blank">Census Labs</a></li>
<li><a href="http://ilug.gr">Ioannina Linux Users Group</a></li>
<li><a href="http://void.gr/kargig/ipv6/" target="_blank">IPv6 material</a></li>
<li><a href="http://planet.gentoo.org/">Planet Gentoo</a></li>
<li><a href="http://www.larrythecow.org/">Planet Larry</a></li>
<li><a href="http://www.sysadminblogs.com/planet/">Planet Sysadmin</a></li>

	</ul>
</li>
  <li id="linkcat-348" class="linkcat"><h2>Projects</h2>
	<ul>
<li><a href="https://github.com/kargig/greek-adblockplus-filter" title="Greek Filters for AdblockPlus" target="_blank">Greek AdblockPlus Filter</a></li>
<li><a href="https://github.com/kargig/https-everywhere-greek-rules" title="HTTPS-Everywhere Greek Rules" target="_blank">HTTPS-Everywhere Greek Rules</a></li>
<li><a href="http://ilug.gr/iloog/" title="Greek Linux LiveCD for Students and Developers" target="_blank">iloog</a></li>
<li><a href="https://tormap.void.gr/" title="World city map of Tor nodes" target="_blank">Tormap</a></li>

	</ul>
</li>
		</ul>		

<ul class="nodecor">
    <li><h2>Meta</h2></li>
     <li><a href="https://www.void.gr/kargig/blog/wp-login.php">Log in</a></li>
</ul>
                        

		
<!-- <h2><a href="http://www.fsf.org/register_form?referrer=7577"><img src="http://void.gr/kargig/fsfmember.png" alt="[FSF Associate Member]" width="88" height="31" /></a></h2> -->


<!--
<h2>Last.fm</h2>
 <a href="http://www.last.fm/user/kargig/?chartstyle=basicrt10"><img src="http://imagegen.last.fm/basicrt10/recenttracks/kargig.gif" width=252 height=178 alt="kargig's Profile Page" /></a>
-->

<h2><a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/gr/"><img alt="Creative Commons License" style="border-width:0;width:88px;height:31px" src="//i.creativecommons.org/l/by-nc-sa/3.0/gr/88x31.png"/></a><br/>This work is licensed under a <a rel="license" href="//creativecommons.org/licenses/by-nc-sa/3.0/gr/">Creative Commons Attribution-Noncommercial-Share Alike 3.0 Greece License</a>.</h2>

<h2>Visits</h2>
10 online / 2264433 total
</div>
</li>
</ul>

  <!-- end sidebar -->
<!-- manager -->
<!-- begin footer -->
</div>
<div id="footer"><p>Using a modified <a href="http://www.ifelse.co.uk/gentle-calm">Gentle Calm theme</a>.</p>
<p>
W o r d P r e s s took 0.726 seconds to generate this
<a href="http://validator.w3.org/check/referer" title="Validate this document as XHTML 1.0 @ W3C.org" >XHTML</a> page.</p>
</div>
<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>469930</strong>  Spams eaten and counting...</div><script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
<script type="text/javascript">_uacct = "UA-1054285-2";urchinTracker();</script>
</body>
</html>
