<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-br" xml:lang="pt-br">
<head>
<link rel="stylesheet" href="/pub/TWiki/JQueryPlugin/jquery-all.css" type="text/css" media="all" />
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-all.js"></script>
<link rel="stylesheet" href="http://ntp.br/pub/TWiki/ImagePlugin/style.css" type="text/css" media="all" />
<link rel="stylesheet" href="http://ntp.br/pub/TWiki/ImageGalleryPlugin/style.css" type="text/css" media="all" />
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
	<link rel="stylesheet" type="text/css" media="screen" href="/pub/NTP/WebModeloNicTemplate/ntp.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/pub/NTP/WebModeloNicTemplate/home.css" />
	<link rel="stylesheet" type="text/css" media="print" href="/pub/NTP/WebModeloNicTemplate/print.css" />
	<link rel="stylesheet" type="text/css" media="handheld" href="/pub/NTP/WebModeloNicTemplate/handheld.css" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="NTP.br, ntp, ntp" />
	<meta name="description" content="NTP.br" />
	<!-- <meta http-equiv="pragma" content="no-cache" /> -->
	<script type="text/javascript" src="scripts.js"></script>
	<script type="text/javascript" src="/pub/NTP/WebModeloNicTemplate/css3-mediaqueries.js"></script>
	<title>NTP.br - Hora Certa via Internet - Estrutura</title>
</head>
<body>
	<div class="header-ceptro">
		<h1><a href="http://www.ceptro.br/"><img src="/pub/NTP/WebModeloNicTemplate/logo-ceptro-top.gif" alt="ceptro.br" width="82" height="28" longdesc="Centro de Estudos e Pesquisas em Tecnologia de Redes e Operações" /></a></h1> 
		<span><a href="http://www.ceptro.br/">Centro de Estudos e Pesquisas em Tecnologia de Redes e Operações</a></span>
		<div class="header-cgi-nic">
			<a href="http://www.on.br/" title="Observatório Nacional"><img src="/pub/NTP/WebModeloNicTemplate/logo-on-top.gif" alt="Observatório Nacional" width="121" height="26" /></a><span class="invisible">|</span>
		    <a href="http://www.cgi.br/" title="Comitê Gestor da Internet no Brasil"><img src="/pub/NTP/WebModeloNicTemplate/logo-cgi-top.gif" alt="CGI.br" width="43" height="27" /></a><span class="invisible">|</span>
		    <a href="http://www.nic.br/" title="Núcleo de Informação e Coordenação do Ponto BR"><img src="/pub/NTP/WebModeloNicTemplate/logo-nic-top.gif" alt="NIC.br" width="41" height="27" /></a>
		</div>
	</div><!--.header-ceptro-->
	<div class="topo">
	  <h2><a href="http://www.ntp.br/" accesskey="1"><img src="/pub/NTP/WebModeloNicTemplate/logo-ntp.gif" alt="NTP.br" class="logo-ntp" width="256" height="58" /></a></h2>
		<span class="ir-conteudo"><a href="#content" accesskey="2">Ir para o conteúdo</a></span>
		<ul>
		    <li><a href="http://pcdsh01.on.br/">Divisão da Hora do Observatório Nacional</a></li>
		    <li><a href="http://www.nic.br/imprensa">Imprensa</a></li>
		    <li class="last"><a href="http://www.ceptro.br/CEPTRO/EnglishHome#NTP_br_Brazilian_Legal_Time_over">English</a></li>
		</ul>
	</div><!--.topo-->
	<div class="container">
		<div class="menu-esq">
		<ul class="menu">
<li><a href="/NTP/MenuNTPIntroducao" class="twikiLink">Introdução</a></li>
<li><a href="/NTP/MenuNTPWindows" class="twikiLink">Guia Windows</a></li>
<li><a href="/NTP/MenuNTPLinuxBSD" class="twikiLink">Guia Linux/BSD</a></li>
<li><a href="/NTP/MenuNTPMac" class="twikiLink">Guia MAC</a></li>
<li><a href="/NTP/MenuNTPRoteadores" class="twikiLink">Guia Roteadores</a></li>
<li><a href="/NTP/MenuNTPTempo" class="twikiLink">O Tempo</a></li>
<li><a href="/NTP/MenuNTPNtp" class="twikiLink">O NTP</a></li>
<li><a href="/NTP/MenuNTPEstrutura" class="twikiCurrentTopicLink twikiLink">Estrutura</a></li>
<li><a href="/NTP/MenuNTPGrafico" class="twikiLink">Gráficos</a></li>
<li><a href="/NTP/MenuNTPAvancado" class="twikiLink">Conf. Avançada</a></li>
<li><a href="/NTP/MenuNTPVocabulario" class="twikiLink">Vocabulário</a></li>
<li><a href="/NTP/MenuNTPFaq" class="twikiLink">FAQ</a></li>
<li><a href="/NTP/MenuNTPLinks" class="twikiLink">Links</a></li>
<li><a href="/NTP/MenuNTPBanners" class="twikiLink">Banners</a></li>
<li><a href="/NTP/MenuNTPContato" class="twikiLink">Contato</a></li>          
</ul>
				<form method="get" action="http://www.google.com/search" title="Busca no site">
			<fieldset>
				<label for="busca"><span class="busca-txt">Busca</span><br />
				<input type="text" size="17" name="q" maxlength="255" value="Buscar por..." id="busca" onfocus="clearDefault(this)" class="busca-campo" /></label>
				<input type="hidden" name="domains" value="cgi.br;nic.br;registro.br;ceptro.br;cetic.br;ceptro.br;w3c.br" /><input type="hidden" name="ie" value="iso-8859-1" /><input type="hidden" name="oe" value="iso-8859-1" /><input type="button" name="sa" value="ok" alt="ok" class="busca-btn" />
				<label class="invisivel" for="busca-no-site">Selecione o site</label>
				<select name="sitesearch" id="busca-no-site" title="Selecione o site" class="busca-select">
					<option value="ntp.br" selected="selected">Buscar em NTP.br...</option>
				    <option value="cgi.br">Buscar em CGI.br</option>
					<option value="nic.br">Buscar em NIC.br</option>
					<option value="registro.br">Buscar em Registro.br</option>
					<option value="cetic.br">Buscar em CETIC.br</option>
					<option value="ceptro.br">Buscar em CEPTRO.br</option>
					<option value="w3c.br">Buscar em W3C.br</option>
				</select>
			</fieldset>
			</form>  
<p />
			<span class="acessibilidade"><a href="http://validator.w3.org/check?uri=referer">V&aacute;lido XHTML</a> </span>
			<span class="acessibilidade"><a href="http://jigsaw.w3.org/css-validator/check/referer">V&aacute;lido CSS</a> </span>
			<span class="acessibilidade"><a href="http://www.ntp.br/NTP/AcessibilidadeSitio" accesskey="3">Acessibilidade do sítio</a></span>
		</div><!--.menu-esq-->
		<div class="conteudo">
			<div class="breadcrumb">
				Você está em: <strong>NTP.br -&gt; Estrutura</strong>
				<div class="seu-ip">Seu <acronym title="Internet Protocol">IP</acronym>: 2001:0:53aa:64c:18ca:5d94:2471:e895 </div>
			</div><!--.breadcrumb-->
<div class="subcontent">
			<a name="content"></a>
<p /><h3><a name="Estrutura"></a> Estrutura </h3>
<a name="VolTar"></a>
<div class="twikiToc"> <ul>
<li> <a href="#Estrutura"> Estrutura</a> <ul>
<li> <a href="#O_acordo_entre_o_ON_e_o_NIC_br"> O acordo entre o ON e o NIC.br</a>
</li> <li> <a href="#A_Estrutura_do_NTP_br"> A Estrutura do NTP.br</a>
</li> <li> <a href="#Gr_ficos_do_servidor_de_monitora"> Gráficos do servidor de monitoração</a>
</li> <li> <a href="#Gr_ficos_dos_servidores_do_NTP_b"> Gráficos dos servidores do NTP.br</a>
</li></ul> 
</li></ul> 
</div>
<div class="voltar"><a href="/NTP/MenuNTPEstrutura#VolTar" class="twikiCurrentTopicLink twikiAnchorLink">Voltar</a></div>
<hr />
<h4><a name="O_acordo_entre_o_ON_e_o_NIC_br"></a> O acordo entre o ON e o NIC.br </h4>
<p />
O projeto <strong>NTP.br</strong> tem por objetivo oferecer condições para que os servidores Internet no Brasil estejam sincronizados com a <strong>Horal Legal Brasileira</strong>. Para isso foi firmado um acordo entre o Observatório Nacional (ON) e o NIC.br.
<p />
O ON tem como atribuição legal a geração, conservação e disseminação da Hora Legal Brasileira. Rastreado ao <em>Bureau International des Poids et Mesures</em> (BIPM), na França, participa do Tempo Universal Coordenado (TUC ou UTC), juntamente com os órgãos disseminadores de tempo e freqüência dos demais países.
<p />
Pelos termos do acordo o ON disponibiliza, sem qualquer ônus, ao Núcleo de Informação e Coordenação do Ponto BR – NIC.br, o sincronismo à Hora Legal Brasileira, seguro, confiável, rastreável e auditável, e o NIC.br disponibiliza, sem qualquer ônus, ao ON um conjunto de equipamentos necessários à manutenção da infra-estrutura de sincronismo.
<div class="voltar"><a href="/NTP/MenuNTPEstrutura#VolTar" class="twikiCurrentTopicLink twikiAnchorLink">Voltar</a></div>
<hr />
<h4><a name="A_Estrutura_do_NTP_br"></a> A Estrutura do NTP.br </h4>
<p />
Os <strong>servidores públicos</strong> estrato 2 do NTP.br são:
<p /> <ul>
<li> <strong>a.ntp.br</strong>
</li> <li> <strong>b.ntp.br</strong>
</li> <li> <strong>c.ntp.br</strong>
</li></ul> 
<p />
Cada um desses endereços representa um servidor duplo: duas lâminas numa <em>blade</em>, cada uma delas com duas placas de rede conectadas a estruturas de rede distintas (routers e switches diferentes). Ou seja, há redundância de <em>hardware</em> e de conectividade, com balanceamento automático. Cada um deles está em um datacenter diferente, com ótima conexão à Internet.
<p />
Eles são alimentados por servidores primários (estrato 1), <strong>também acessíveis publicamente</strong>:
<p /> <ul>
<li> <strong>a.st1.ntp.br</strong>
</li> <li> <strong>b.st1.ntp.br</strong>
</li> <li> <strong>c.st1.ntp.br</strong> 
</li> <li> <strong>d.st1.ntp.br</strong>
</li></ul> 
<p />
Esses, por sua vez, são sincronizados com relógios atômicos, que são de responsabilidade do Observatório Nacional.
<p />
Existe também um servidor que utilizamos para monitoração do sistema. É um servidor ntp estrato 1, sincronizado com o Sistema de Posicionamento Global (GPS). Ele também pode ser usado:
<p /> <ul>
<li> <strong>gps.ntp.br</strong>
</li></ul> 
<p />
O servidor de monitoração consulta todos os servidores estrato 1 e estrato 2 do NTP.br e através de seus logs são gerados gráficos que podem ser visualizados nesta página.
<p />
A figura a seguir representa a estrutura do NTP.br:
<div class="img-centro"><img src="/pub/NTP/MenuNTPEstrutura/ntp-estrutura.png" alt="ntp-estrutura.png" width='600' height='349' /></div>
<p class="legenda">Figura 1</p>
<div class="voltar"><a href="/NTP/MenuNTPEstrutura#VolTar" class="twikiCurrentTopicLink twikiAnchorLink">Voltar</a></div>
<hr />
<h4><a name="Gr_ficos_do_servidor_de_monitora"></a> Gráficos do servidor de monitoração </h4>
<p />
Na seção <a href="/NTP/MenuNTPGrafico" class="twikiLink">Gráficos</a> é possível visualizar os gráficos produzidos pelo servidor de monitoração. Esses gráficos são baseados nas estatísticas do ntp, coletadas através dos logs <em>loopstats</em> e <em>peerstats</em> desse servidor.
<p />
É importante notar que as medidas são feitas sempre em relação ao servidor de monitoração e que as condições de tráfego na rede podem influenciar os resultados. A qualidade da sincronização do servidor de monitoração também pode influenciar o resultado.
<p />
Para ajudar a interpretar os gráficos, seguem algumas explicações mais detalhadas:
<p /> <ul>
<li> <strong>Deslocamento de a, b e c.ntp.br em relacao ao serv. de monitoracao</strong>: Este gráfico é o que melhor resume as condições dos servidores públicos do ntp.br, apresentando a diferença de tempo entre eles e o UTC, do ponto de vista do servidor de monitoração. Nesse gráfico cada servidor redundando é apresentado como um só: um detalhamento é apresentado em outros gráficos. Espera-se manter os deslocamentos na faixa de até poucos milisegundos.
</li></ul> 
<p /> <ul>
<li> <strong>Servidores estrato 1 do ntp.br em rel. ao serv. de monitoracao</strong>: Este gráfico resume as condições dos servidores estrato 1. Note-se que não há praticamente degradação da qualidade do tempo fornecido entre o estrato 1 e o estrato 2. Os servidores estrato 1 não são públicos.
</li></ul> 
<p /> <ul>
<li> <strong>Outros servidores em relacao ao servidor de monitoracao</strong>: Este gráfico ajuda a verificar a qualidade de sincronização do próprio servidor de monitoração, comparando-o com alguns servidores públicos estrato 1 de fora do projeto ntp.br. Alguns resultados, como os dos servidores estadunidenses (nist e usno) são fortemente influenciados pela qualidade da rede.
</li></ul> 
<p /> <ul>
<li> <strong>Servidor de monitoracao em comparacao com suas referencias</strong>: Este gráfico  é o que melhor permite avaliar a qualidade de sincronização do servidor de monitoração, em relação às suas referências. A linha indicada como "referência" é a medida do relógio local do servidor (loopstats) e espera-se que sua diferença em relação ao zero e às referências não ultrapasse algumas dezenas de microsegundos.
</li></ul> 
<p /> <ul>
<li> <strong>Deslocamento de x.ntp.br (onde x pode ser a, b ou c)</strong>: Estes gráficos detalham as medidas para cada servidor público. Como se sabe cada servidor é composto por duas lâminas, cada uma com duas conexões à Internet diferentes. Então quando se acessa x.ntp.br, pode-se acessar: <ul>
<li> <em>x1-1</em>: lâmina 1 placa de rede 1;
</li> <li> <em>x1-2</em>: lâmina 1 placa de rede 2;
</li> <li> <em>x2-1</em>: lâmina 2 placa de rede 1;
</li> <li> <em>x2-2</em>: lâmina 2 placa de rede 2.
</li></ul> 
</li></ul> 
<p /> <ul>
<li> <strong>Atraso (ida e volta) de x.ntp.br (onde x pode ser a, b ou c)</strong>: Apresentam o mesmo detalhamento que os gráficos explicados no item anterior, mas com as medidas de tempo de ida e volta dos pacotes, permitindo avaliar a qualidade das conexões de rede entre o servidor de monitoração e os servidores públicos.
</li></ul> 
<div class="voltar"><a href="/NTP/MenuNTPEstrutura#VolTar" class="twikiCurrentTopicLink twikiAnchorLink">Voltar</a></div>
<hr />
<h4><a name="Gr_ficos_dos_servidores_do_NTP_b"></a> Gráficos dos servidores do NTP.br </h4>
<p />
Na seção <a href="/NTP/MenuNTPGrafico" class="twikiLink">Gráficos</a> estão disponíveis também os gráficos obtidos à partir dos dados (<em>loopstats</em> e <em>peerstats</em>) de cada um dos servidores:
<p /> <ul>
<li> <strong>Deslocamento medido x.ntp.br</strong>: Estes gráficos detalham a forma como cada servidor vê suas referências de tempo. A medida é sempre em relação ao relógio local do servidor e não mais em relação ao servidor de monitoração.
</li></ul> 
<p /> <ul>
<li> <strong>Atraso (ida e volta) medido por x.ntp.br</strong>: Apresentam os valores de tempo de ida e volta dos pacotes medidos pelos servidores em relação às suas referências de tempo, permitindo avaliar a qualidade das conexões de rede entre os mesmos.
</li></ul> 
<p />
<p />
<p />
		</div><!--.conteudo-->
</div>
	</div><!--.container-->
	<noscript><p>Script para limpar os campos de formulario</p></noscript>
</body>
</html>